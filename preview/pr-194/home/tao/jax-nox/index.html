<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
<link rel="stylesheet" href="https:&#x2F;&#x2F;unpkg.com&#x2F;boxicons@2.1.4&#x2F;css&#x2F;boxicons.min.css" media="print" onload="this.media='all'; this.onload = null">
<noscript><link rel="stylesheet" href="https:&#x2F;&#x2F;unpkg.com&#x2F;boxicons@2.1.4&#x2F;css&#x2F;boxicons.min.css"></noscript>

    
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/spacegrotesk.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-sans-300.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-sans-400.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-sans-500.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-sans-600.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-sans-700.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-mono-300.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-mono-400.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-mono-500.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-mono-600.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://docs.elodin.systems/preview/pr-194/fonts/ibm-plex-mono-700.woff2" type="font/woff2" crossorigin>

    
<link rel="stylesheet" href="https://docs.elodin.systems/preview/pr-194/main.css">

    
  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://docs.elodin.systems/preview/pr-194/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://docs.elodin.systems/preview/pr-194/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://docs.elodin.systems/preview/pr-194/favicon-16x16.png">
  
    <link rel="manifest" href="https://docs.elodin.systems/preview/pr-194/site.webmanifest" crossorigin>
  


  
  
    
  

  
  
    
    
  

  
    
  
  
  
  
    
  

  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>NumPy, JAX & NOX | Elodin</title>
<meta name="description" content="JAX &amp; NOX">
<link rel="canonical" href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/">


  <meta name="twitter:card" content="summary_large_image">
  
    <meta name="twitter:image" content="https://docs.elodin.systems/preview/pr-194/logo.png">
  
  <meta name="twitter:title" content="NumPy, JAX &amp; NOX">
  <meta name="twitter:description" content="JAX &amp; NOX">
  <meta name="twitter:site" content="@elodinsystems">
  <meta name="twitter:creator" content="@elodinsystems">

  <meta property="og:title" content="NumPy, JAX &amp; NOX">
  <meta property="og:description" content="JAX &amp; NOX">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/">

  
    <meta property="og:image" content="https://docs.elodin.systems/preview/pr-194/logo.png">
  

  <meta property="og:updated_time" content="">
  <meta property="og:site_name" content="NumPy, JAX &amp; NOX">

  

  

  
  <meta property="og:locale" content="en_US">





  





<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://docs.elodin.systems/preview/pr-194/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Home",
            "item": "https://docs.elodin.systems/preview/pr-194/home/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "Tao",
            "item": "https://docs.elodin.systems/preview/pr-194/home/tao/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "Jax Nox",
            "item": "https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/"
          },
        
      
    
  }
</script>




</head>

<body class="docs single">
  
    
    
    
  
  
    
<header class="navbar fixed-top navbar-expand-md navbar-light">
    <div class="container">
        <div class="col-2" style="display: flex; gap: 20px">
            <a
                href="https://elodin.systems"
                class="nav-link-icon"
                target="_blank"
                rel="noopener noreferrer"
                ><svg
                    width="20"
                    height="25"
                    viewBox="0 0 20 25"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M10 0H15C17.7615 0 20 2.23858 20 5V20.0001C20 22.7615 17.7615 25.0001 15 25.0001H5C2.23853 25.0001 0 22.7615 0 20V5C0 2.23858 2.23853 1.90735e-06 5 1.90735e-06V5V20.0001H15V5L5 5C5 2.23858 7.23853 0 10 0Z"
                        fill="currentColor"
                    />
                </svg>
            </a>
            <span>
                <select name="version" class="version-select" disabled>
                    <option value="v0.15.1" selected>
                        v0.15.1
                    </option>
                </select>
            </span>
        </div>

        <div
            class="col-2 d-none d-lg-block"
            style="margin-left: 56px"
        >
            <form style="width: 264px">
                <input
                    id="userinput"
                    class="form-control is-search"
                    type="search"
                    placeholder="Search"
                    aria-label="Search"
                    autocomplete="off"
                />
                <div id="suggestions" class="shadow bg-white rounded"></div>
            </form>
        </div>
        <div class="col-2 d-none d-md-block"></div>
        <div class="col-2" style="margin-left: 35px">
            <ul class="navbar-nav main-nav me-auto">
                      
                <li
                    class="nav-item home active"
                >
                    <a
                        class="nav-link"
                        href="https://docs.elodin.systems/preview/pr-194/home/quickstart"
                        >HOME</a
                    >
                </li>
                  
                <li
                    class="nav-item"
                >
                    <a
                        class="nav-link"
                        href="https://docs.elodin.systems/preview/pr-194/reference/overview"
                        >Reference</a
                    >
                </li>
                  
                <li
                    class="nav-item"
                >
                    <a
                        class="nav-link"
                        href="https://docs.elodin.systems/preview/pr-194/releases/changelog"
                        >Releases</a
                    >
                </li>
                  
            </ul>
        </div>
        <div class="col-1"></div>
        <div
            class="col-2 d-none d-xl-block"
            style="margin-right: 63px"
        >
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link nav-link-icon" href="https://github.com/elodin-sys/elodin">
                        <i class="bx bxl-github"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-icon" href="https://elodin.app/discord">
                        <i class="bx bxl-discord-alt"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a id="mode-1" class="nav-link nav-link-icon toggle-dark">
                        <i class='bx bxs-sun'></i>
                    </a>
                    <a id="mode-2" class="nav-link nav-link-icon toggle-light">
                        <i class='bx bxs-moon'></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</header>

  
  <div class="wrap container tom-green" role="document">
      <div class="content">
          <div class="row flex-xxl-nowrap justify-content-center">
              
<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
    <nav class="docs-links" aria-label="Main navigation">
          
        <h3>Overview</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class="docs-link "
                    href="https://docs.elodin.systems/preview/pr-194/home/quickstart/"
                    >Quick Start</a
                >
            </li>
            
            <li>
                <a
                    class="docs-link "
                    href="https://docs.elodin.systems/preview/pr-194/home/3-body/"
                    >Three-Body Orbit</a
                >
            </li>
            
            <li>
                <a
                    class="docs-link "
                    href="https://docs.elodin.systems/preview/pr-194/home/bouncing-ball/"
                    >Bouncing Ball</a
                >
            </li>
            
        </ul>
          
         
        <h3>Aleph</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/aleph/setup/"
                    >Aleph Setup</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/aleph/fc-board-flash/"
                    >Flash Expansion Board</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/aleph/reset/"
                    >Factory Reset</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/aleph/betaflight/"
                    >Betaflight Install</a
                >
            </li>
            
        </ul>
         
         
        <h3>Elodin DB</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/db/overview/"
                    >Overview</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/db/architecture/"
                    >Architecture</a
                >
            </li>
            
        </ul>
         
         
        <h3>The Tao of Elodin Sim</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/tao/introduction/"
                    >What is Elodin</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/tao/ecs/"
                    >Why ECS for Physics?</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/tao/data-flow/"
                    >ECS Data Flow</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="https://docs.elodin.systems/preview/pr-194/home/tao/monte-carlo/"
                    >Monte Carlo</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link active"
                    href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/"
                    >NumPy, JAX &amp; NOX</a
                >
            </li>
            
        </ul>
          
    </nav>
</div>

               
<nav
    class="docs-toc d-none d-xxl-block col-xl-3"
    aria-label="Secondary navigation"
>
    <div class="page-links">
        <h3>On this page</h3>
        <nav id="TableOfContents">
            <ul>
                
                <li><a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#jax">JAX</a></li>
                
                <ul>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#automatic-differentiation">Automatic Differentiation</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#just-in-time-compilation">Just-in-Time Compilation</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#gpu-tpu-acceleration">GPU &amp; TPU Acceleration</a>
                    </li>
                    
                </ul>
                 
                <li><a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#nox">Nox</a></li>
                
                <ul>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#performance">Performance</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#production-ready">Production-Ready</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#integration">Integration</a>
                    </li>
                    
                </ul>
                 
                <li><a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#and-the-sharp-bits">And The &quot;Sharp Bits&quot;</a></li>
                
                <ul>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#immutable-arrays">Immutable Arrays</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#pure-functions-no-side-effects">Pure Functions, No Side Effects</a>
                    </li>
                    
                    <li>
                        <a href="https://docs.elodin.systems/preview/pr-194/home/tao/jax-nox/#subtle-differences-from-numpy">Subtle Differences from NumPy</a>
                    </li>
                    
                </ul>
                 
            </ul>
        </nav>
    </div>
</nav>
 
              <main class="docs-content col-lg-11 col-xxl-10">
                  <h1>NumPy, JAX &amp; NOX</h1>
                   <p>When setting about to develop an open and composable physics engine, deciding how to support numerical computation in an efficient and
expressive manner was a key exploration. An obvious inspiration we looked to was the <a href="https://numpy.org/">Python NumPy</a> ecosystem.</p>
<p>If you're not familiar with NumPy, imagine you're working with a massive dataset or a matrix of numbers, and you need to perform calculations
efficiently. Normally, doing that with regular Python lists would be slow and memory-hungry. Enter NumPy: a tool
for high-performance number crunching in Python. NumPy solves this problem by offloading expensive math operations to a fast hyper-optimized C library.</p>
<p>NumPy gives you <code>ndarrays</code>, which are multi-dimensional arrays that are faster and more memory-efficient than Python's built-in lists. You can
also do vectorized operations on these arrays—so instead of writing loops to process each element, NumPy lets you apply operations to entire
arrays at once, like performing element-wise math in parallel. NumPy's core innovation is that it lets you perform vectorized operations on
multi-dimensional arrays. A vectorized operation means that the CPU operates on multiple entries in an array simultaneously. NumPy's syntax
is also less verbose – so instead of writing [2 * x for x in array] you can just write 2 * array and NumPy handles the rest for you.</p>
<p>It's also the backbone for other major scientific libraries like SciPy and pandas. NumPy is the most popular way of expressing math in
Python. It's commonly used in virtually every field, and has developed a large eco-system of libraries.</p>
<p>As a result, NumPy has become a staple for numerical computation across schools and industries.</p>
<h2 id="jax">JAX</h2>
<p>NumPy sounds great! So why not use it for Elodin?</p>
<p>Millions of simulations running in parallel is a common use case for Elodin. When you are trying to perform a large series of mathematical
expressions, finding a way to optimize becomes important. That's where <a href="https://jax.readthedocs.io/en/latest/">JAX</a> comes in.</p>
<p>JAX is like NumPy’s supercharged cousin. It gives you all the things you love about NumPy—fast, efficient array operations—but with some
game-changing extras that make it ideal for machine learning and other performance-heavy tasks.</p>
<h4 id="automatic-differentiation">Automatic Differentiation</h4>
<p>First, JAX can automatically compute derivatives of functions, which is super useful for things like training neural networks. You can
define a function, and JAX will figure out how to differentiate it for you, no extra coding required. This is called automatic differentiation,
popular in machine learning because finding the gradient of a function is crucial for training neural networks.</p>
<h4 id="just-in-time-compilation">Just-in-Time Compilation</h4>
<p>Second, JAX uses something called just-in-time (JIT) compilation. Normally, when you run Python code, it’s interpreted line by line,
which can be slow. But JAX can take your code and compile it to run way faster, like low-level machine code. So you get the flexibility of
Python but with near-C++ performance.</p>
<h4 id="gpu-tpu-acceleration">GPU &amp; TPU Acceleration</h4>
<p>Third, it can easily run your computations on GPUs and TPUs by compiling to <a href="https://openxla.org/xla">XLA</a>, without you having to manage
all that complexity. You just write Python code, and JAX handles sending it to the GPU in the background.</p>
<p>JAX is like NumPy, but optimized for high-performance computing, like running massive monte-carlo simulations.</p>
<h2 id="nox">Nox</h2>
<p>Enter Nox, a Rust implementation of JAX. Nox is a Rust library that provides a NumPy-like interface for numerical computing, but with the
performance and power of JAX. It's a Rust port of JAX, which means you can write your code in Rust and get all the benefits of JAX, like
automatic differentiation and just-in-time compilation.</p>
<p>JAX sounded great! So why re-write JAX in Rust to create Nox? For us, it boils down to 3 reasons.</p>
<h4 id="performance">Performance</h4>
<p>One is that the JAX tracing process can get a little slow for more complex programs. By bringing Jaxprs into Rust, we can optimize the
compile path more. This doesn't matter for small simple programs, but for larger programs (especially with lots of unrolling) it could matter a lot.</p>
<h4 id="production-ready">Production-Ready</h4>
<p>The 2nd reason is that we prefer Rust for making production-ready software. The strong type-system especially allows you to catch many errors
at compile time, and while Python is moving in that direction, it isn't there yet.</p>
<h4 id="integration">Integration</h4>
<p>The 3rd reason is that we want this software to easily integrate with your existing flight software (the control software for your drone/satellite),
and using a "systems" language like Rust makes that easier. Eventually, we would love to build out a suite of flight software in Rust that can easily
integrate with the simulation but is still flight-ready.</p>
<p>A fun side-effect of this architecture is Nox allows you to write code for both simulations and flight software generically, allowing for seamless
"software in the loop" and "hardware in the loop" testing of your flight software.</p>
<h2 id="and-the-sharp-bits">And The "Sharp Bits"</h2>
<p>While it's tempting dive in thinking the use of JAX/NOX in Elodin will be just like NumPy, the
<a href="https://jax.readthedocs.io/en/latest/notebooks/Common_Gotchas_in_JAX.html">Sharp Bits</a> still apply, namely:</p>
<h4 id="immutable-arrays">Immutable Arrays</h4>
<p>In JAX, once you create an array, you can’t change it directly. Think of it like a "look but don’t touch" rule. Instead of modifying an
array in place, JAX forces you to create new arrays with your changes. This can feel weird if you’re used to NumPy, where you can just tweak
things in-place. The immutability is important for making sure JAX’s optimizations work smoothly, but it takes a bit of getting used to.</p>
<h4 id="pure-functions-no-side-effects">Pure Functions, No Side Effects</h4>
<p>JAX loves pure functions—meaning no messing around with global variables, no printing from inside the function, nothing that changes outside
the function's scope. It sounds strict, but it’s necessary for JAX’s magic, like automatic differentiation and just-in-time compilation, to
work properly. So, if you try to sneak in a print statement while debugging, JAX will throw a fit!</p>
<h4 id="subtle-differences-from-numpy">Subtle Differences from NumPy</h4>
<p>JAX feels a lot like NumPy, but there are some small gotchas. For example, some NumPy functions you’re used to might be missing or work a
little differently. JAX is really built for numbers and arrays—if you try to work with anything else, like random Python objects, JAX won’t be happy.</p>

                  
<div class="footer-line-padding"></div>
<div class="footer-line"></div>
<div class="docs-navigation d-flex justify-content-between">
                                                
    <a href="https:&#x2F;&#x2F;docs.elodin.systems&#x2F;preview&#x2F;pr-194&#x2F;home&#x2F;tao&#x2F;monte-carlo&#x2F;">
        <div>
            <div class="footer-card">&larr; Monte Carlo</div>
        </div>
    </a>
       
    <!-- this is a spacing hack for expediency -->
    <div class="footer-separator"></div>
         
</div>

              </main>
          </div>
      </div>
  </div>
  
<script type="text/javascript" src="https://docs.elodin.systems/preview/pr-194/js/main.js"></script>
<script>
    // https://mathjax.github.io/MathJax-demos-web/convert-configuration/convert-configuration.html
    window.MathJax = {
        tex: {
            inlineMath: [
                ["$", "$"],
                ["\\(", "\\)"],
            ],
            displayMath: [
                ["$$", "$$"],
                ["\[\[", "\]\]"],
            ],
            processEscapes: true,
            processEnvironments: true,
        },
        options: {
            skipHtmlTags: ["script", "noscript", "style", "textarea", "pre"],
        },
    };
</script>
<script type="text/javascript" src="https://docs.elodin.systems/preview/pr-194/js/tex-mml-chtml.js"></script>

  <script type="text/javascript" src="https://docs.elodin.systems/preview/pr-194/js/elasticlunr.min.js"></script>
  <script type="text/javascript" src="https://docs.elodin.systems/preview/pr-194/search_index.en.js"></script>
  <script type="text/javascript" src="https://docs.elodin.systems/preview/pr-194/js/search.js"></script>


</body>

</html>
