<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
<link rel="stylesheet" href="https:&#x2F;&#x2F;unpkg.com&#x2F;boxicons@2.1.4&#x2F;css&#x2F;boxicons.min.css" media="print" onload="this.media='all'; this.onload = null">
<noscript><link rel="stylesheet" href="https:&#x2F;&#x2F;unpkg.com&#x2F;boxicons@2.1.4&#x2F;css&#x2F;boxicons.min.css"></noscript>

    
  <link rel="preload" as="font" href="/fonts/spacegrotesk.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-sans-300.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-sans-400.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-sans-500.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-sans-600.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-sans-700.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-mono-300.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-mono-400.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-mono-500.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-mono-600.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="/fonts/ibm-plex-mono-700.woff2" type="font/woff2" crossorigin>

    
<link rel="stylesheet" href="/main.css">

    
  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  
    <link rel="manifest" href="/site.webmanifest" crossorigin>
  


  
  
    
  

  
  
    
    
  

  
    
  
  
  
  
    
  

  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>ECS Data Flow | Elodin</title>
<meta name="description" content="ECS Data Flow">
<link rel="canonical" href="/home/tao/data-flow/">


  <meta name="twitter:card" content="summary_large_image">
  
    <meta name="twitter:image" content="//logo.png">
  
  <meta name="twitter:title" content="ECS Data Flow">
  <meta name="twitter:description" content="ECS Data Flow">
  <meta name="twitter:site" content="@elodinsystems">
  <meta name="twitter:creator" content="@elodinsystems">

  <meta property="og:title" content="ECS Data Flow">
  <meta property="og:description" content="ECS Data Flow">
  <meta property="og:type" content="article">
  <meta property="og:url" content="/home/tao/data-flow/">

  
    <meta property="og:image" content="//logo.png">
  

  <meta property="og:updated_time" content="">
  <meta property="og:site_name" content="ECS Data Flow">

  

  

  
  <meta property="og:locale" content="en_US">





  





<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": ":///"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Home",
            "item": ":///home/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "Tao",
            "item": ":///home/tao/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "Data Flow",
            "item": ":///home/tao/data-flow/"
          },
        
      
    
  }
</script>




</head>

<body class="docs single">
  
    
    
    
  
  
    
<header class="navbar fixed-top navbar-expand-md navbar-light">
    <div class="container">
        <div class="col-2" style="display: flex; gap: 20px">
            <a
                href="https://elodin.systems"
                class="nav-link-icon"
                target="_blank"
                rel="noopener noreferrer"
                ><svg
                    width="20"
                    height="25"
                    viewBox="0 0 20 25"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M10 0H15C17.7615 0 20 2.23858 20 5V20.0001C20 22.7615 17.7615 25.0001 15 25.0001H5C2.23853 25.0001 0 22.7615 0 20V5C0 2.23858 2.23853 1.90735e-06 5 1.90735e-06V5V20.0001H15V5L5 5C5 2.23858 7.23853 0 10 0Z"
                        fill="currentColor"
                    />
                </svg>
            </a>
            <span>
                <select name="version" class="version-select" disabled>
                    <option value="v0.15.1" selected>
                        v0.15.1
                    </option>
                </select>
            </span>
        </div>

        <div
            class="col-2 d-none d-lg-block"
            style="margin-left: 56px"
        >
            <form style="width: 264px">
                <input
                    id="userinput"
                    class="form-control is-search"
                    type="search"
                    placeholder="Search"
                    aria-label="Search"
                    autocomplete="off"
                />
                <div id="suggestions" class="shadow bg-white rounded"></div>
            </form>
        </div>
        <div class="col-2 d-none d-md-block"></div>
        <div class="col-2" style="margin-left: 35px">
            <ul class="navbar-nav main-nav me-auto">
                      
                <li
                    class="nav-item home active"
                >
                    <a
                        class="nav-link"
                        href="/home/quickstart"
                        >HOME</a
                    >
                </li>
                  
                <li
                    class="nav-item"
                >
                    <a
                        class="nav-link"
                        href="/reference/overview"
                        >Reference</a
                    >
                </li>
                  
                <li
                    class="nav-item"
                >
                    <a
                        class="nav-link"
                        href="/releases/changelog"
                        >Releases</a
                    >
                </li>
                  
            </ul>
        </div>
        <div class="col-1"></div>
        <div
            class="col-2 d-none d-xl-block"
            style="margin-right: 63px"
        >
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link nav-link-icon" href="https://github.com/elodin-sys/elodin">
                        <i class="bx bxl-github"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link nav-link-icon" href="https://elodin.app/discord">
                        <i class="bx bxl-discord-alt"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a id="mode-1" class="nav-link nav-link-icon toggle-dark">
                        <i class='bx bxs-sun'></i>
                    </a>
                    <a id="mode-2" class="nav-link nav-link-icon toggle-light">
                        <i class='bx bxs-moon'></i>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</header>

  
  <div class="wrap container tom-green" role="document">
      <div class="content">
          <div class="row flex-xxl-nowrap justify-content-center">
              
<div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block">
    <nav class="docs-links" aria-label="Main navigation">
          
        <h3>Overview</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class="docs-link "
                    href="/home/quickstart/"
                    >Quick Start</a
                >
            </li>
            
            <li>
                <a
                    class="docs-link "
                    href="/home/3-body/"
                    >Three-Body Orbit</a
                >
            </li>
            
            <li>
                <a
                    class="docs-link "
                    href="/home/bouncing-ball/"
                    >Bouncing Ball</a
                >
            </li>
            
        </ul>
          
         
        <h3>Aleph</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/aleph/setup/"
                    >Aleph Setup</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/aleph/fc-board-flash/"
                    >Flash Expansion Board</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/aleph/reset/"
                    >Factory Reset</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/aleph/betaflight/"
                    >Betaflight Install</a
                >
            </li>
            
        </ul>
         
         
        <h3>Elodin DB</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/db/overview/"
                    >Overview</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/db/architecture/"
                    >Architecture</a
                >
            </li>
            
        </ul>
         
         
        <h3>The Tao of Elodin Sim</h3>
        <ul class="list-unstyled">
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/tao/introduction/"
                    >What is Elodin</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/tao/ecs/"
                    >Why ECS for Physics?</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link active"
                    href="/home/tao/data-flow/"
                    >ECS Data Flow</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/tao/monte-carlo/"
                    >Monte Carlo</a
                >
            </li>
            
            <li>
                <a
                    class=" docs-link"
                    href="/home/tao/jax-nox/"
                    >NumPy, JAX &amp; NOX</a
                >
            </li>
            
        </ul>
          
    </nav>
</div>

               
<nav
    class="docs-toc d-none d-xxl-block col-xl-3"
    aria-label="Secondary navigation"
>
    <div class="page-links">
        <h3>On this page</h3>
        <nav id="TableOfContents">
            <ul>
                
                <li><a href="/home/tao/data-flow/#impel">Impel</a></li>
                 
            </ul>
        </nav>
    </div>
</nav>
 
              <main class="docs-content col-lg-11 col-xxl-10">
                  <h1>ECS Data Flow</h1>
                   <p>One of the pernicious difficulties we encountered developing the physics toolkit was how different components should communicate.
The trouble is that the physics toolkit is entirely customizable, so it's possible to have infinite possible data combinations.
Thankfully, ECS provides an exceedingly simple way of syncing data between systems.</p>
<h2 id="impel">Impel</h2>
<p>We call this protocol Impel. You can send data as a tuple of the entity id, component id, and value, like so:</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>EntityId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> ComponentId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>pos<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> Vector3<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span><span class="z-punctuation z-separator z-rust">,</span><span class="z-constant z-numeric z-integer z-decimal z-rust">1</span><span class="z-punctuation z-separator z-rust">,</span><span class="z-constant z-numeric z-integer z-decimal z-rust">3</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>This might not seem impressive at first blush, but it offers some really nice benefits. Say the control software wants to update the simulated motor rpm; all it would have to do is send the following msg to the simulation software.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>EntityId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">2</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> ComponentId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>motor_rpm<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">2.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>The simulation software can also send out sensor output this same way.</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>EntityId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">3</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> ComponentId<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">&quot;</span>accelerometer_reading<span class="z-punctuation z-definition z-string z-end z-rust">&quot;</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-separator z-rust">,</span> Vector3<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-keyword z-operator z-arithmetic z-rust">-</span><span class="z-constant z-numeric z-float z-rust">8.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>This is nice because it means reacting to new inputs and producing outputs that work with the same systems that we use for the core simulation above.</p>
<p>We use Impel to record the entire state of the system. We create a recorder service that subscribes to all components and entities from the simulation and control software. Every time it receives a message, it adds it to a table. Then, you can use that data to query the entire state of the system at any time. This allows users to specify failure and success conditions with ease; simply write a statement like</p>
<pre data-lang="rust" class="language-rust z-code"><code class="language-rust" data-lang="rust"><span class="z-source z-rust"><span class="z-support z-function z-rust">assert</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>entity<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-decimal z-rust">3</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span>pos <span class="z-keyword z-operator z-comparison z-rust">==</span> <span class="z-support z-function z-rust">vector3</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-float z-rust">1.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-float z-rust">0.</span><span class="z-constant z-numeric z-float z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span>
</span></code></pre>
<p>We can also use that data to provide real-time visualization of the simulation, graphs, and other analytics about the output. And since this is just a generic data exchange protocol, it also works for generic telemetry out of your software. Store and analyze anything you want: memory usage, performance stats, internal metrics about your Kalman filter; it doesn't matter.</p>

                  
<div class="footer-line-padding"></div>
<div class="footer-line"></div>
<div class="docs-navigation d-flex justify-content-between">
                                          
    <a href="&#x2F;home&#x2F;tao&#x2F;ecs&#x2F;">
        <div>
            <div class="footer-card">&larr; Why ECS for Physics?</div>
        </div>
    </a>
       
    <!-- this is a spacing hack for expediency -->
    <div class="footer-separator"></div>
        
    <a href="&#x2F;home&#x2F;tao&#x2F;monte-carlo&#x2F;">
        <div>
            <div class="footer-card">Monte Carlo &rarr;</div>
        </div>
    </a>
           
</div>

              </main>
          </div>
      </div>
  </div>
  
<script type="text/javascript" src="/js/main.js"></script>
<script>
    // https://mathjax.github.io/MathJax-demos-web/convert-configuration/convert-configuration.html
    window.MathJax = {
        tex: {
            inlineMath: [
                ["$", "$"],
                ["\\(", "\\)"],
            ],
            displayMath: [
                ["$$", "$$"],
                ["\[\[", "\]\]"],
            ],
            processEscapes: true,
            processEnvironments: true,
        },
        options: {
            skipHtmlTags: ["script", "noscript", "style", "textarea", "pre"],
        },
    };
</script>
<script type="text/javascript" src="/js/tex-mml-chtml.js"></script>

  <script type="text/javascript" src="/js/elasticlunr.min.js"></script>
  <script type="text/javascript" src="/search_index.en.js"></script>
  <script type="text/javascript" src="/js/search.js"></script>


</body>

</html>
