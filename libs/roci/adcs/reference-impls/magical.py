#!/usr/bin/env python3

import sys

import jax
import jax.numpy as np
import jax.numpy.linalg as la
import matplotlib.pyplot as plt
import numpy


def estimate_step(y, m):
    ones = np.reshape(np.repeat(1.0, m.shape[1]), (1, m.shape[1]))
    g = np.concat([m, ones], axis=0)
    # print(repr(g))
    # L = y @ g.T @ np.linalg.inv(g @ g.T)
    y_g_t = y @ g.T
    print(repr(y_g_t))
    L = y_g_t @ np.linalg.inv(g @ g.T)
    return L


def estimate(y):
    m = jax.vmap(lambda x: x / la.norm(x))(y).T
    y = y.T
    j = 500.0
    for _ in range(512):
        L = estimate_step(y, m)
        T = L[:, :3]
        h = L[:, 3]
        print(f"T = {repr(T)}")
        T_inv = la.inv(T)
        print(T_inv)
        m_tilde = jax.vmap(lambda x: T_inv @ (x - h))(y.T)
        j = np.sum(jax.vmap(lambda x: (la.norm(x) ** 2 - 1) ** 2)(m_tilde))
        m = jax.vmap(lambda x: x / la.norm(x))(m_tilde).T
        print(j)
        if j < 0.00001:
            return m_tilde.T
    raise Exception(f"failed to converge {j}")


y = np.array(
    [
        [28.9565, -36.0629, 3.7774],
        [78.9057, 38.3372, 101.5674],
        [-32.1998, 17.6587, 106.9128],
        [78.2886, 45.5759, 55.5238],
        [-6.5465, 1.2463, -54.1607],
        [-76.4068, -1.7360, 33.1313],
        [56.4391, 50.4230, 13.3214],
        [-45.6277, -21.1381, -50.6529],
        [-26.1110, -54.8770, 19.3353],
        [60.9085, 57.3747, 31.2507],
        [15.9137, 4.3693, -43.6785],
        [16.1267, -22.8032, 113.4894],
        [49.2287, 69.7567, 47.8374],
        [35.8123, 17.7558, 137.0308],
        [50.3566, 55.4264, 12.3881],
        [82.6287, 16.1037, 76.5728],
        [-75.7509, -7.2491, 36.0492],
        [24.6334, -43.3432, 62.2292],
        [45.6904, 63.6385, 107.3012],
        [31.7579, 18.4734, 137.3591],
        [-68.5292, -35.2200, 23.1271],
        [62.7553, -1.9885, 111.0026],
        [-68.0356, 17.9689, -19.6365],
        [55.4953, 23.7821, 131.7831],
        [-32.9166, 8.4092, 107.4931],
        [-11.3391, -47.7802, 67.4520],
        [60.1674, -21.2992, 57.5419],
        [6.8112, 71.3474, 27.3604],
        [-58.2550, 39.0650, 25.0235],
        [-10.3676, -20.7439, -48.9995],
        [-5.9333, -52.9526, 12.2465],
        [-3.4294, 23.2825, -48.2269],
        [41.4373, 8.1259, 133.3333],
        [56.2415, 43.0257, 5.2978],
        [-16.3640, 14.4835, 120.7981],
        [-13.7829, -28.8656, -44.2652],
        [65.3255, 38.4857, 15.3258],
        [-18.9562, -3.5899, 116.4421],
        [40.1042, -36.1691, 62.0971],
        [-8.9257, -33.7240, -37.2938],
        [-45.1277, -3.4634, -54.5979],
        [55.8585, 33.5469, -1.6735],
        [69.1568, 59.8631, 62.0526],
        [35.2536, -25.2855, -6.9467],
        [52.6162, 49.6823, 7.4493],
        [6.8698, 68.8436, 16.1055],
        [36.5166, -21.8820, -9.7870],
        [2.7480, -43.6315, -13.2256],
        [-11.4169, 43.5410, 111.3983],
        [51.6012, -28.1767, 66.3650],
        [-65.8203, -23.0500, 52.3861],
        [-1.1464, -50.9715, 53.7490],
        [-14.0091, 67.6974, 45.1902],
        [33.5875, 73.0501, 80.6271],
        [46.5354, 72.1721, 71.3025],
        [-74.4669, -16.1146, 36.3198],
        [-63.6061, 26.9541, 46.3933],
        [-56.1969, -3.8916, 78.9526],
        [-32.8633, 17.8053, 106.1993],
        [2.2266, -36.7054, 93.6533],
        [-67.1819, 4.0043, -35.1879],
        [-18.1019, 50.8800, 96.0530],
        [-65.9756, -24.7590, 50.2299],
        [-51.9901, -22.7794, 75.2459],
        [18.6872, -5.3029, 128.8040],
        [-16.9736, -40.9558, 81.6554],
        [-35.0482, -37.1996, 76.4699],
        [72.0258, 57.9899, 77.4809],
        [80.3463, 8.4734, 70.4838],
        [34.6947, 64.9780, 106.4833],
        [-7.4633, -8.9760, 120.2068],
        [-79.1214, -7.4694, -8.7570],
        [-28.0132, -38.3207, 80.1317],
        [75.6716, 4.3648, 92.8921],
        [-20.9559, -54.8824, 27.8940],
        [-42.3782, -50.9664, 31.1736],
        [48.8736, 51.6491, 123.2649],
        [6.8630, 72.8849, 38.8203],
        [-60.2363, -27.7220, -37.6571],
        [-63.8618, 29.9410, 37.6245],
        [-58.7772, -9.5221, 73.5186],
        [-71.8385, 20.1546, 1.7527],
        [-41.3544, 52.0562, 10.7851],
        [71.1979, 56.6680, 91.3064],
        [-34.1130, -29.1080, 87.9228],
        [48.2387, 44.4557, -2.9803],
        [-11.4891, 51.9377, 101.7099],
        [-57.9737, 39.4134, 16.7548],
        [-50.1345, 42.4041, 53.0803],
        [-75.7305, -26.8152, -2.2477],
        [-42.3722, -52.3296, 13.6958],
        [30.3738, 66.5035, 102.8696],
        [1.0464, 51.1683, -22.4980],
        [5.7907, 71.5871, 29.4484],
        [23.5864, 17.3344, 136.9025],
        [-32.0488, 49.8409, -13.5755],
        [24.5803, -8.1608, 126.7940],
        [38.8044, 48.5233, -7.9826],
        [-27.6657, 57.9621, 64.8126],
        [-38.1973, -32.5167, 80.2711],
        [-44.8305, 4.5923, 94.8100],
        [-2.4645, 64.0752, 88.2884],
        [-50.3094, 19.4055, 83.5373],
        [-46.0178, -51.2420, 13.2805],
        [75.3533, 34.3246, 111.4265],
        [-68.4140, 13.3761, -25.1742],
        [46.9900, -14.5621, 111.3645],
        [47.9702, 10.4686, 132.0256],
        [-8.2750, 64.3605, 80.0633],
        [29.3602, 69.4917, 94.9421],
        [60.6119, 11.9580, 124.9275],
        [23.5590, 36.9172, -29.0088],
        [57.7981, -21.6867, 76.4875],
        [-15.5860, -5.7843, 117.6366],
        [67.5724, 0.7978, 107.1232],
        [24.1113, -16.5410, 119.4700],
        [40.5873, 73.3265, 55.6771],
        [81.5807, 26.0208, 51.3860],
        [-64.6434, 24.9358, 46.7303],
        [-72.9009, -0.3145, -27.1790],
        [-68.3721, -6.5359, -36.8592],
        [39.3785, -3.8130, -21.2124],
        [8.6569, 33.8725, 130.2176],
        [18.4958, 15.6470, 136.0237],
        [15.4177, -46.1819, 12.3124],
        [73.1500, 53.9357, 55.1226],
        [-6.7212, 66.2898, 12.9714],
        [-53.2203, -11.4974, -50.5398],
        [-34.2915, 48.6511, -14.0309],
        [36.3279, 67.7545, 23.2612],
        [-63.2946, 18.0464, -29.0424],
        [-66.4085, -9.6050, -39.5207],
        [28.5199, 73.4870, 40.3640],
        [64.5412, -16.7330, 61.5306],
        [12.6600, -10.0786, -42.3247],
        [-78.2864, -20.6799, 7.1324],
        [73.6955, 9.8858, 30.6206],
        [31.9488, 18.6572, -31.2535],
        [-66.8003, -36.3352, 26.3682],
        [67.1162, 4.9517, 112.6049],
        [-35.1729, 16.1064, -51.9489],
        [-15.7351, 25.3114, 119.0795],
        [38.0895, 20.7371, 137.0668],
        [62.8776, 25.0396, 126.9674],
        [-60.3023, 36.1424, 31.0463],
        [-46.1154, -46.8843, 42.7342],
        [6.4726, -27.8676, -34.2865],
        [42.3812, 71.3921, 43.9375],
        [35.3475, 54.2777, 122.5001],
        [-71.3658, 19.5716, -4.1002],
        [64.9506, -2.2533, 107.4032],
        [64.2389, 59.6139, 99.5068],
        [35.9705, -19.8960, -12.9115],
        [-41.1213, -36.5130, 71.7868],
        [-43.9533, 50.2677, 44.7555],
        [52.7021, 65.6792, 37.6534],
        [76.4028, 18.7207, 107.4093],
        [-73.2786, -5.2262, 44.2886],
        [-71.5399, 2.6202, 48.1603],
        [-12.1719, 31.2679, 119.2943],
        [39.8085, 22.7670, 136.9171],
        [-18.2263, -40.5166, 81.9264],
        [5.3793, 52.3861, -20.1776],
        [84.0550, 25.2934, 75.6627],
        [-78.5594, 4.0701, 2.7859],
        [-28.4741, 59.7748, 15.7102],
        [21.2898, -13.7566, 122.4630],
        [20.2227, -39.5024, -1.8908],
        [-32.1777, 14.4608, -53.4353],
        [30.1953, 74.2063, 72.9093],
        [-65.2494, 12.9885, 58.9847],
        [42.5275, 39.7966, -12.5611],
        [7.1227, -2.7886, -47.9018],
        [51.9545, 69.6178, 82.1630],
        [74.8630, 21.4847, 111.7403],
        [20.5179, -5.4970, -38.4152],
        [77.0606, 10.1102, 97.7872],
        [3.5601, -18.5573, -43.6703],
        [-61.3600, 17.6541, 64.4057],
        [-23.9447, -4.5563, 112.7035],
        [26.7164, -4.1775, 129.3868],
        [49.5384, 71.3982, 66.6836],
        [3.8301, -19.3280, -43.0239],
        [-1.9440, -52.5167, 43.6472],
        [63.9071, 9.3606, 120.2484],
        [68.1301, 7.3140, 18.2206],
        [64.4893, -14.4971, 80.8145],
        [32.4909, 32.8031, 136.0723],
        [10.7029, -49.9219, 26.5972],
        [67.5436, 1.7861, 108.4275],
        [4.7743, -29.2094, 105.3663],
        [25.7252, 42.4028, -23.3531],
        [5.6266, 14.1371, -48.3721],
        [-14.3147, -5.1040, 118.6495],
        [-71.4114, -33.6425, -3.0270],
        [-34.7287, 2.8196, -56.5654],
        [66.8169, -13.3978, 51.7209],
        [39.3506, 39.2785, -15.8237],
        [6.0218, -46.9586, 67.5554],
        [-10.5572, 55.0248, -15.3657],
        [6.4397, -42.8541, 80.0813],
        [2.5193, 61.8344, 98.2388],
        [-3.3471, 58.3204, -10.3261],
        [-68.7393, -16.1786, -35.0458],
        [-79.5023, -15.2020, 0.2347],
        [-15.9985, -36.7183, -36.6349],
        [-38.8035, 0.5092, 101.1594],
        [29.9962, 65.1837, 105.6712],
        [-75.9939, -21.0330, 24.8848],
        [63.5641, 64.1163, 60.3026],
        [-80.0511, -5.1678, 4.7683],
        [-34.4526, -30.3000, 86.2855],
        [82.3727, 38.9117, 66.6498],
        [75.4231, 37.4366, 110.0600],
        [-65.1064, -2.4185, -40.4250],
        [-51.1228, 0.9765, 86.7163],
        [-13.2030, -4.5245, 119.5056],
        [-0.8618, 9.6275, 129.3622],
        [61.4312, -4.0294, 12.9205],
        [23.2163, 18.6059, -37.7453],
        [84.0401, 25.1215, 76.0160],
        [30.1668, -28.9577, 100.0595],
        [-19.9093, 59.3983, 0.2734],
        [49.1756, -29.4583, 69.7606],
        [79.9947, 42.1992, 93.5768],
        [-45.4819, -9.0027, 91.4424],
        [-78.2110, 2.9593, -4.7405],
        [-76.7372, -24.4735, 10.9262],
        [17.8430, 9.0355, 134.8010],
        [29.4058, 35.1236, 135.1461],
        [-19.6344, -48.9124, 61.5593],
        [4.0404, -51.9082, 27.3596],
        [-75.4395, 3.3496, -17.7575],
        [-28.6565, -27.9579, -48.2490],
        [-26.4120, -42.1386, 74.3673],
        [4.5280, 2.7709, 129.8443],
        [57.2890, 49.3430, 121.5498],
        [-8.3840, -29.1446, 102.6737],
        [34.2382, 54.9192, -3.6990],
        [-11.5510, -18.1344, -50.8618],
        [45.1300, 71.4232, 82.1116],
        [23.2218, -0.9264, 131.4257],
        [61.5269, 63.6824, 91.8403],
        [-0.1796, 34.0779, -40.7752],
        [75.9993, 51.5949, 89.1782],
        [40.1014, -16.3000, 113.9517],
        [55.3000, -19.2604, 91.9082],
        [61.6323, 31.6131, 5.5328],
        [41.3449, 1.3119, -21.0916],
        [20.0884, -17.8588, 118.6235],
        [69.1692, -2.8751, 98.1109],
        [-38.0012, 48.3801, 69.2592],
        [-47.4048, -46.7603, -15.9081],
        [-11.6357, 64.1293, 75.5648],
        [78.0709, 36.8762, 104.7083],
        [31.6591, 21.2925, -30.8949],
        [69.9670, -10.0468, 67.4267],
        [-69.8508, 7.3853, -28.3135],
        [44.7632, 59.1133, 12.1269],
        [-8.0516, -53.2995, 42.5186],
        [35.5175, 71.6580, 87.2175],
        [77.1895, 11.3210, 40.9016],
        [-64.8034, -21.9819, 55.4810],
        [34.5079, 74.4256, 57.1469],
        [37.5658, 70.6992, 34.4656],
        [10.0508, -45.6124, 70.0993],
        [-76.4447, -6.2403, 33.5251],
        [-52.4202, -25.3657, -45.2436],
        [-4.3551, -16.5425, -48.8591],
        [38.5321, -30.8376, 88.2467],
        [21.8293, -41.9678, 8.1215],
        [33.6127, -40.2186, 34.7468],
        [-42.5219, 46.7322, 62.7583],
        [-28.3934, -34.4794, -42.1087],
        [-64.2278, 24.7794, 48.4130],
        [76.7472, 45.5301, 49.1361],
        [-16.4285, -49.0642, 62.2735],
        [-54.5502, -47.7048, 12.4084],
        [11.3797, 45.6672, 124.3592],
        [-37.4755, 31.6497, -38.7577],
        [12.8189, 74.2751, 50.6586],
        [37.5796, 70.4742, 33.5729],
        [4.5800, 15.4226, -48.5060],
        [70.7580, 50.6027, 105.9144],
        [27.1335, 24.3159, -33.3675],
        [-51.6847, -47.7137, 27.1278],
        [-8.9235, -53.9376, 36.6339],
        [48.9170, 59.1586, 113.9805],
        [-33.7268, -14.8487, -55.3779],
        [23.1753, -45.5587, 46.4870],
        [39.6267, 46.6685, 129.2200],
        [1.5895, 7.0698, -51.0788],
        [-2.8443, 7.6678, 128.1837],
        [-17.1842, -13.6537, -54.3574],
        [-14.1712, 40.0531, 112.0497],
        [-59.4801, 16.2094, 69.3647],
        [7.6896, 70.2503, 21.5658],
        [58.4455, 31.2371, 0.7317],
        [69.5161, 6.3228, 22.1551],
        [-12.8827, -0.0350, 121.2724],
        [-8.2342, 58.9861, 93.3627],
        [21.8584, -45.8620, 30.2334],
        [24.1667, 74.7145, 66.6455],
        [-43.3368, -51.6803, 4.3045],
        [-64.3037, 17.7690, -27.6803],
        [-39.4913, 50.4423, -1.5079],
        [-63.4590, -33.7830, 42.3351],
        [10.4931, 73.8939, 47.0484],
        [-17.4360, 31.1318, -44.6862],
        [48.8802, 52.9785, 121.9087],
        [73.3081, 18.3290, 25.6939],
        [36.2530, -22.0708, -9.9201],
        [76.0153, 12.3962, 103.3550],
        [15.1793, 73.2781, 35.9368],
        [-5.4738, -38.4886, 89.6425],
        [39.1471, 7.7403, 133.7625],
        [56.5025, 68.5570, 75.4848],
        [54.7869, -2.0223, -1.1487],
        [18.2829, -27.3655, -24.7898],
        [52.8226, 28.4987, 133.0742],
        [45.1579, 72.4870, 59.8786],
        [-54.8385, -47.5827, 11.3587],
        [-14.8601, 62.6671, 6.3804],
        [-2.4716, 70.3018, 63.4545],
        [51.8686, -10.1409, 0.8290],
        [-78.5352, 2.7298, 16.5005],
        [50.3409, 44.3829, -0.7221],
        [-19.7519, 0.5722, 117.1854],
        [-9.6161, -6.8997, 120.2910],
        [79.5575, 21.6219, 43.5330],
        [-17.3137, 31.8956, -44.0661],
        [42.3099, 50.1766, -3.0179],
        [-5.9410, -43.9108, 78.4018],
        [-20.1071, -46.6896, -20.9696],
        [20.9348, 44.3125, 128.8347],
        [8.1401, 34.6380, -37.9304],
        [26.0988, 66.7174, 13.3955],
        [44.1260, 55.0687, 5.0487],
        [-46.8848, -36.9169, -36.3912],
        [-5.2653, -52.7501, 45.0212],
        [-32.0041, -24.4114, 94.3816],
        [54.9983, 69.0750, 77.0834],
        [49.8412, -17.8664, 6.8446],
        [-48.7907, -22.8576, 79.2018],
        [26.9428, -31.4859, -8.9242],
        [72.9426, -0.8781, 91.2446],
        [71.1652, 22.0588, 20.3932],
        [-38.1180, -9.4147, 98.9717],
        [47.8002, 50.6284, 124.5626],
        [50.2495, 37.8927, -5.9252],
        [-44.1881, 42.9779, 67.5286],
        [26.3434, 8.9567, -36.5456],
        [-63.6353, -33.7960, 41.8985],
        [8.6490, -48.9645, 12.6579],
        [55.4684, 69.1706, 67.7991],
        [-39.8060, 52.9313, 48.5576],
        [-67.7961, -30.8661, 36.8954],
        [47.6804, 68.1026, 37.6802],
        [3.4716, -49.9425, 55.9882],
        [47.1702, 63.3425, 23.3278],
        [-35.0980, -28.6291, -47.7570],
        [51.5550, -26.6570, 32.9956],
        [-39.8810, -31.0814, 80.4526],
        [-16.1120, -49.3032, 61.5964],
        [7.3626, -51.1283, 36.0533],
        [-58.5061, 12.7314, -40.2458],
        [66.1345, 21.5084, 10.5019],
        [46.7152, 57.0450, 117.7727],
        [12.6577, 56.2924, 113.9794],
        [7.2324, -16.0025, -42.9470],
        [34.9039, 71.5380, 35.3599],
        [-46.8962, -44.6974, 48.2098],
        [31.3556, -36.8944, 10.8452],
        [-46.5279, -49.0782, -7.8216],
        [21.6312, 71.9676, 29.0602],
        [-16.6880, -43.5595, -26.2475],
        [-4.8709, 67.7087, 73.1366],
        [-43.8138, 43.9526, -13.0911],
        [40.4331, 66.7249, 101.9825],
        [-24.2973, -37.3180, 84.1358],
        [20.0023, 19.7911, 136.4839],
        [18.5784, -45.7532, 17.5425],
        [-56.4498, -4.3476, -48.7518],
        [60.3829, 46.7094, 121.7382],
        [-49.3758, -46.9505, -13.0549],
        [-64.5820, 28.9289, 37.3436],
        [-28.3583, -46.8565, 62.3706],
        [31.6998, -25.6732, -11.4280],
        [51.7434, 21.3455, -10.8305],
        [40.3179, -29.4194, 9.5957],
        [-36.2371, -14.0699, 98.4153],
        [-5.2458, -52.5764, 46.3223],
        [45.1487, 28.0590, -16.4937],
        [19.6693, 52.4678, 121.4558],
        [-65.4813, -31.5848, 41.6218],
        [-76.0940, -26.4222, 0.8216],
        [78.9203, 30.6371, 104.6427],
        [-50.6910, 45.9667, 15.6728],
        [-43.5541, -31.7133, 75.9141],
        [-52.0832, 10.9806, -46.8469],
        [41.5503, 72.4035, 79.8037],
        [-47.1138, 21.5630, -42.7929],
        [-35.0758, 57.4004, 38.4580],
        [78.6813, 48.9559, 81.1573],
        [-5.3633, 61.1590, 91.9976],
        [-9.2933, 68.7572, 56.4957],
        [29.5552, 63.6232, 108.6467],
        [71.8604, 43.4307, 112.1191],
        [-62.1379, -37.7748, 36.5898],
        [-65.5690, -10.1665, -40.4930],
        [30.2292, 65.4104, 105.2353],
        [17.5816, 5.7018, -42.6825],
        [-21.2088, -6.0089, 114.0424],
        [-23.5376, 58.5426, 1.4001],
        [-32.7547, 9.9688, 107.5892],
        [-13.0179, -39.0106, 86.7117],
        [-78.3650, -20.3657, 7.5244],
        [-21.2671, -54.7878, 14.0173],
        [34.4156, 74.5171, 63.3980],
        [-59.6341, 26.4875, 58.9902],
        [61.0718, 5.9486, 4.9145],
        [17.7874, 7.2635, 134.3210],
        [-50.6895, 43.9186, 45.6417],
        [30.8481, 31.9775, 136.2272],
        [50.7058, 56.4243, 117.1330],
        [-78.0361, 4.9106, 16.8644],
        [33.0115, 63.4831, 109.3161],
        [-45.9285, 40.6128, 68.3178],
        [-26.9704, 61.9573, 30.3804],
        [-76.8544, -5.6568, 31.8651],
        [-40.2070, 28.7990, -40.2746],
        [52.7765, -27.6522, 47.3034],
        [-56.2209, 19.9711, 73.0605],
        [22.7567, -31.4325, -14.4265],
        [45.4590, 69.8473, 89.8622],
        [-8.7974, 34.2411, 120.2051],
        [48.6684, -16.8586, 106.2855],
        [10.5613, 23.8035, 133.7484],
        [2.4275, 51.8960, -21.3079],
        [56.3245, -15.8635, 17.7676],
        [18.0157, 73.6711, 72.1243],
        [51.2740, 51.8139, 8.4396],
        [-0.4330, -15.5247, -47.5168],
        [10.3378, 72.4420, 32.1047],
        [25.2814, -32.0758, -10.1617],
        [73.6195, 19.5927, 113.1327],
        [-23.2450, -41.3640, 77.7851],
        [-0.6943, -15.3228, 118.5471],
        [77.0914, 34.8312, 107.8670],
        [-6.5953, -47.5692, 68.5284],
        [35.9651, 26.5621, -25.6829],
        [-74.0985, -24.8413, -16.7508],
        [29.2573, -42.0986, 29.2298],
        [0.2830, 53.4915, -19.0811],
        [-8.2071, -44.7889, -19.3679],
        [17.5555, -46.1119, 59.7189],
        [68.8498, 60.2691, 84.0228],
        [36.4333, -29.6208, 2.4922],
        [-39.9770, 54.2912, 23.4760],
        [-51.8561, -6.4622, -51.6903],
        [-20.6283, -53.5386, 2.9124],
        [-3.4244, 23.0676, -48.3295],
        [-57.9577, -41.6707, 35.9019],
        [19.2525, -35.7115, -11.4177],
        [51.8221, -3.6951, -4.7236],
        [-80.1171, -7.0104, 6.6815],
        [67.4343, 5.7827, 17.6535],
        [83.5659, 25.4338, 64.3673],
        [-71.0954, -10.8432, 48.9196],
        [-27.7672, 61.6471, 37.7369],
        [72.5570, -5.9580, 57.5207],
        [-41.5918, 50.6752, 4.3209],
        [37.0529, 18.8422, 137.0263],
        [58.7051, 57.6074, 27.8463],
        [14.4804, -0.7133, 130.8404],
        [-20.3952, 63.6349, 19.0423],
        [-42.6973, 49.9511, 4.1487],
        [70.6675, 2.5359, 28.7130],
        [-68.4760, -1.2872, -35.5978],
        [-46.7232, -49.4668, 30.3520],
        [-74.7555, -9.5546, 38.9329],
        [68.1907, 44.6601, 116.0703],
        [-43.4402, -14.6740, 90.9888],
        [-71.4085, -10.3762, -32.0786],
        [65.8352, -12.8388, 42.3527],
        [-10.3880, 65.7999, 71.4475],
        [-51.0330, -36.2768, -35.0574],
        [-65.4333, 6.8950, -35.9723],
        [22.6818, 73.9863, 41.0995],
        [22.1451, 74.9093, 61.5433],
        [70.0191, 52.9173, 42.3049],
        [55.9768, -0.0175, -0.5009],
        [78.3141, 6.3105, 54.1647],
        [0.1303, -31.5062, 101.6719],
        [69.6756, -7.7857, 84.0528],
        [-53.3501, 24.6407, 74.6218],
        [55.8738, 22.4919, 131.4481],
        [35.8267, -38.3433, 30.2291],
        [-32.5967, -32.6759, -44.1888],
        [-27.3726, 60.7313, 52.1026],
    ]
)

data_points = 10
y = y[:data_points]
y_norm = np.sum(jax.vmap(lambda x: la.norm(x))(y)) / data_points
print(f"y_norm = {y_norm}")
ax = plt.figure().add_subplot(projection="3d")
ax.scatter(y[:, 0], y[:, 1], y[:, 2], color="blue")
m = estimate(y).T
numpy.set_printoptions(threshold=sys.maxsize)
print(np.array_repr(numpy.array(m)))
m = m * y_norm
ax.scatter(m[:, 0], m[:, 1], m[:, 2], color="red")
ax.set_xlim([-120, 120])
ax.set_ylim([-120, 120])
ax.set_zlim([-120, 120])
ax.set_box_aspect((1, 1, 1))

u, v = np.mgrid[0 : 2 * np.pi : 30j, 0 : np.pi : 30j]
x = y_norm * np.cos(u) * np.sin(v)
y = y_norm * np.sin(u) * np.sin(v)
z = y_norm * np.cos(v)
ax.plot_wireframe(x, y, z, color=("g", 0.2))
plt.show()
